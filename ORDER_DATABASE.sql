CREATE TABLE SALESMAN(
SALESMAN_ID INTEGER PRIMARY KEY,
NAME VARCHAR(20),
CITY VARCHAR(20), 
COMMISION VARCHAR(20));

DESC SALESMAN;

CREATE TABLE CUSTOMER( 
CUST_ID INTEGER PRIMARY KEY, 
CUST_NAME VARCHAR(20), 
CITY VARCHAR(20), 
GRADE INTEGER,
SALESMAN_ID INTEGER, 
FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)ON DELETE SET NULL);

DESC CUSTOMER;

CREATE TABLE ORDERS( 
ORDER_NO INTEGER PRIMARY KEY, 
PURCHASE_AMT INTEGER,
ORDER_DATE DATE, 
CUST_ID INTEGER, 
SALESMAN_ID INTEGER, 
FOREIGN KEY(CUST_ID) REFERENCES CUSTOMER(CUST_ID) ON DELETE CASCADE, 
FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE CASCADE);

DESC ORDERS;

INSERT INTO SALESMAN VALUES(1000,'RAHUL','BANGALORE','20%');
INSERT INTO SALESMAN VALUES(2000,'ANKITA','BANGALORE','25%');
INSERT INTO SALESMAN VALUES(3000,'SHARMA','MYSORE','30%');
INSERT INTO SALESMAN VALUES(4000,'ANJALI','DELHI','15%');
INSERT INTO SALESMAN VALUES(5000,'RAJ','HYDERABAD','15%');
SELECT * FROM SALESMAN;

INSERT INTO CUSTOMER VALUES(1,'ADYA','BANGALORE',100,1000);
INSERT INTO CUSTOMER VALUES(2,'BANU','MANGALORE',300,1000);
INSERT INTO CUSTOMER VALUES(3,'CHETHAN','CHENNAI',400,2000);
INSERT INTO CUSTOMER VALUES(4,'DANISH','BANGALORE',200,2000);
INSERT INTO CUSTOMER VALUES(5,'ESHA','BANGALORE',400,3000);
SELECT * FROM CUSTOMER;

INSERT INTO ORDERS VALUES(201,5000,'2020-06-02',1,1000);
INSERT INTO ORDERS VALUES(202,450,'2020-04-09',1,2000);
INSERT INTO ORDERS VALUES(203,1000,'2020-03-15',3,2000);
INSERT INTO ORDERS VALUES(204,3500,'2020-07-09',4,3000);
INSERT INTO ORDERS VALUES(205,550,'2020-05-05',2,2000);
SELECT * FROM ORDERS;

QUERIES:
1.
SELECT COUNT(*)
FROM CUSTOMER WHERE GRADE>(
SELECT AVG(GRADE)
FROM CUSTOMER 
WHERE CITY='BANGALORE');

2.
SELECT SALESMAN_ID, NAME 
FROM SALESMAN 
WHERE SALESMAN_ID IN(
SELECT SALESMAN_ID 
FROM CUSTOMER C 
GROUP BY SALESMAN_ID 
HAVING COUNT(*)>1);

3.
(SELECT DISTINCT S.SALESMAN_ID, S.NAME, 'SAME CITY' 
FROM CUSTOMER C, SALESMAN S WHERE C.SALESMAN_ID=S.SALESMAN_ID AND C.CITY=S.CITY) 
UNION 
(SELECT DISTINCT S.SALESMAN_ID, S.NAME, 'DIFFERENT CITY'
FROM CUSTOMER C, SALESMAN S WHERE C.SALESMAN_ID=S.SALESMAN_ID AND C.CITY!=S.CITY) 
UNION(SELECT DISTINCT S.SALESMAN_ID, S.NAME, 'NO CUSTOMER' 
FROM SALESMAN S WHERE SALESMAN_ID NOT IN(SELECT SALESMAN_ID FROM CUSTOMER));

4.
CREATE VIEW HIGHEST_ORDERS AS
SELECT B.ORDER_DATE, A.SALESMAN_ID, A.NAME, B.CUST_ID 
FROM SALESMAN A,ORDERS B 
WHERE A.SALESMAN_ID=B.SALESMAN_ID AND B.PURCHASE_AMT=(
SELECT MAX(PURCHASE_AMT) 
FROM ORDERS C 
WHERE C.ORDER_DATE=B.ORDER_DATE);

SELECT * FROM HIGHEST_ORDERS;

5.
DELETE FROM SALESMAN WHERE SALESMAN_ID=1000;

SELECT * FROM SALESMAN;
SELECT * FROM ORDERS;
